<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>pandas 기초 사용법 - 홍가뤼의 개인위키</title>

    <meta name="description" content="필요하여 찾다가 알게된 기초 사용법 적음">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://honggaruy.github.io/wiki/pandas-basic/">
    <link rel="alternate" type="application/rss+xml" title="홍가뤼의 개인위키" href="https://honggaruy.github.io/feed.xml">

    <meta property="og:type" content="website">
    <meta property="og:title" content="pandas 기초 사용법">
    <meta property="og:description" content="필요하여 찾다가 알게된 기초 사용법 적음">
    <meta property="og:image" content="https://honggaruy.github.io/resources/icon/apple-touch-icon.png">
    <meta property="og:url" content="https://honggaruy.github.io/wiki/pandas-basic/">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:url" content="https://honggaruy.github.io/wiki/pandas-basic/">
    <meta name="twitter:title" content="pandas 기초 사용법">
    <meta name="twitter:description" content="필요하여 찾다가 알게된 기초 사용법 적음">

    <link rel="apple-touch-icon" sizes="180x180" href="/resources/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/resources/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/resources/icon/favicon-16x16.png">
    <link rel="manifest" href="/resources/icon/site.webmanifest">




</head>
<body>
<header class="header">
    <div>
        <a class="site-title" href="/">홍가뤼의 개인위키</a>
    </div>
    <div>
        <a class="site-title-right" href="/about/">me</a>
    </div>
    <div>
        <a class="site-title-right" href="/wiki/index/#random" onclick="if(typeof random === 'function')random()">random</a>
    </div>
    <div>
        <a class="site-title-right" href="/blog/">blog</a>
    </div>
    <div>
        <a class="site-title-right" href="/wiki/index/">wiki</a>
    </div>
</header>

    
        <div class="page-content">
            <div class="search">
    <form role="search" method="get" action="/search/">
         <input name="searchString" class="searchInput" placeholder=" 검색하세요" type="text">
         <input type="submit" class="searchButton" value="Search">
    </form>
</div>
            <div class="post">
                
<input type="hidden" id="thisName" value="pandas-basic">
<div class="post">
    <header class="post-header">
        <h1 class="post-title">pandas 기초 사용법</h1>
    
        <p class="title-summary">필요하여 찾다가 알게된 기초 사용법 적음</p>
    
        <div class="history-button">
            <p><a href="https://github.com/honggaruy/honggaruy.github.io/blame/master/_wiki/pandas-basic.md" target="_blank">created: 2021.07.15</a></p>
            <p><a href="https://github.com/honggaruy/honggaruy.github.io/blame/master/_wiki/pandas-basic.md" target="_blank">updated: 2023.11.04</a></p>
            <p>
                <a href="https://github.com/honggaruy/honggaruy.github.io/edit/master/_wiki/pandas-basic.md">편집하기</a>
                
                /
                <a href="https://github.com/honggaruy/honggaruy.github.io/issues/new?title=pandas+%EA%B8%B0%EC%B4%88+%EC%82%AC%EC%9A%A9%EB%B2%95&amp;body=%EC%9D%98%EA%B2%AC%EC%9D%84%20%EB%82%A8%EA%B2%A8%EC%A3%BC%EC%84%B8%EC%9A%94">의견 남기기</a>
                
            </p>
        </div>
        <div id="parent-list"></div>


    <div class="post-tag">
    pandas python
</div>




    </header>
    <article class="post-content">
        <ul id="markdown-toc">
  <li><a href="#dataframe%EC%97%90%EC%84%9C-%EA%B0%92-counting-%ED%95%98%EA%B8%B0" id="markdown-toc-dataframe에서-값-counting-하기">dataframe에서 값 counting 하기</a></li>
  <li><a href="#%ED%8A%B9%EC%A0%95-%EA%B8%B0%EA%B0%84%EC%9D%98-%EC%97%B0%EB%8F%84-%EB%8B%AC-list%EB%A5%BC-%EC%83%9D%EC%84%B1%ED%95%98%EB%8A%94-%EA%B0%84%EB%8B%A8%ED%95%9C-%EB%B0%A9%EB%B2%95" id="markdown-toc-특정-기간의-연도-달-list를-생성하는-간단한-방법">특정 기간의 “연도-달” list를 생성하는 간단한 방법</a></li>
  <li><a href="#pandas%EB%A1%9C-%EB%82%A0%EC%A7%9C-%EB%81%BC%EB%A6%AC-%EB%B9%84%EA%B5%90%ED%95%98%EA%B8%B0" id="markdown-toc-pandas로-날짜-끼리-비교하기">pandas로 날짜 끼리 비교하기</a></li>
  <li>
<a href="#series-%EB%82%B4-%EC%97%90%EC%84%9C-%ED%8A%B9%EC%A0%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EA%B0%80-%EC%9E%88%EB%8A%94%EC%A7%80-%ED%99%95%EC%9D%B8%ED%95%A0-%EB%95%8C-%EC%9E%90%EC%A3%BC-%ED%98%BC%EB%8F%99%ED%95%A8" id="markdown-toc-series-내-에서-특정-데이터가-있는지-확인할-때-자주-혼동함">Series 내 에서 특정 데이터가 있는지 확인할 때 자주 혼동함</a>    <ul>
      <li><a href="#%EC%83%81%ED%99%A9-%EC%84%A4%EB%AA%85" id="markdown-toc-상황-설명">상황 설명</a></li>
      <li><a href="#%EB%AC%B8%EC%A0%9C-%EB%B6%84%EC%84%9D" id="markdown-toc-문제-분석">문제 분석</a></li>
      <li><a href="#%ED%95%B4%EA%B2%B0%EC%B1%85" id="markdown-toc-해결책">해결책</a></li>
    </ul>
  </li>
</ul>

<h1 id="dataframe에서-값-counting-하기">dataframe에서 값 counting 하기</h1>

<ul>
  <li><a href="https://pandas.pydata.org/docs/getting_started/intro_tutorials/06_calculate_statistics.html?highlight=counting#count-number-of-records-by-category">Count number of records by categroy, pandas official</a></li>
  <li>
<code class="language-html highlighter-rouge">pd.Dataframe.value_counts()</code> 함수를 사용한다</li>
</ul>

<h1 id="특정-기간의-연도-달-list를-생성하는-간단한-방법">특정 기간의 “연도-달” list를 생성하는 간단한 방법</h1>

<ul>
  <li>예1 : ‘2018-09’부터 ‘2019-03’까지 1달 단위로 증가하는 String list 만들기
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
<td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
  
<span class="n">period_index</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">period_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'2018-09-01'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'2019-03-01'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'M'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">period_index</span><span class="p">)</span>   
<span class="c1"># PeriodIndex(['2018-09', '2018-10', ... , '2019-03'], dtype='period[M]', freq='M') 
</span> 
<span class="n">str_index</span> <span class="o">=</span> <span class="n">period_index</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">str_index</span><span class="p">)</span>   
<span class="c1"># Index(['2018-09', '2018-10', ... , '2019-03'], dtype='object') 
</span>  
<span class="n">month_list</span> <span class="o">=</span> <span class="n">str_index</span><span class="p">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">month_list</span><span class="p">)</span>
<span class="c1"># ['2018-09', '2018-10', '2018-11', '2018-12', '2019-01', '2019-02', '2019-03']
</span> 
<span class="c1"># 한줄로 쓸 수도 있지만, 길어지는게 싫어서 나누어 씀
</span></pre></td>
</tr></tbody></table></code></pre></div>    </div>
    <ul>
      <li>참고링크
        <ul>
          <li><a href="https://pandas.pydata.org/docs/user_guide/timeseries.html#overview">pd.date_range() 간단한 예제 확인</a></li>
          <li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Period.strftime.html"> strftime() 함수에 사용하는 포맷팅 문자 설명</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="pandas로-날짜-끼리-비교하기">pandas로 날짜 끼리 비교하기</h1>

<ul>
  <li>시작일과 종료일을 parameter로 받는 함수를 만들 때 <code class="language-html highlighter-rouge">시작일 <span class="nt">&lt;</span><span class="err">=</span> <span class="na">종료일</span></code>을 assertion 하고자 한다</li>
  <li>datetime 라이브러리 말고 pandas로 하려고 할 때 어떻게 할까 ?</li>
  <li>다음 링크를 참조 했다. <a href="https://www.geeksforgeeks.org/comparing-timestamp-in-python-pandas/">Comparing Timestamp in Python - Pandas</a>
</li>
  <li>테스트 코드
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="k">assert</span> <span class="n">pd</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">end_date</span><span class="p">),</span> <span class="sa">f</span><span class="s">'오류! 시작일(</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s">)이 종료일(</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s">)보다 미래시간임'</span>
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h1 id="series-내-에서-특정-데이터가-있는지-확인할-때-자주-혼동함">Series 내 에서 특정 데이터가 있는지 확인할 때 자주 혼동함</h1>

<h2 id="상황-설명">상황 설명</h2>
<ul>
  <li>우선 아래 도서대여 테이블의 경우에서</li>
</ul>

<table>
  <thead>
    <tr>
      <th>인덱스</th>
      <th>사용자</th>
      <th>대출기관</th>
      <th>상태</th>
      <th>반납일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>철수</td>
      <td>구로도서관</td>
      <td>반납연기</td>
      <td>2022-09-15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>영희</td>
      <td>구로도서관</td>
      <td>반납연기</td>
      <td>2022-09-15</td>
    </tr>
    <tr>
      <td>2</td>
      <td>철수</td>
      <td>동작도서관</td>
      <td>반납연기</td>
      <td>2022-09-15</td>
    </tr>
    <tr>
      <td>3</td>
      <td>철수</td>
      <td>동작도서관</td>
      <td>반납연기</td>
      <td>2022-10-01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>영희</td>
      <td>동작도서관</td>
      <td>반납연기</td>
      <td>2022-10-01</td>
    </tr>
    <tr>
      <td>5</td>
      <td>길동</td>
      <td>–없음–</td>
      <td>–없음–</td>
      <td>–없음–</td>
    </tr>
    <tr>
      <td>6</td>
      <td>둘리</td>
      <td>–없음–</td>
      <td>–없음–</td>
      <td>–없음–</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>길동이와 둘리는 대여한 도서가 없는 경우 목록에서 제외하는 것이 아니라’–없음–’ 으로 표기를 하기로 했다</li>
  <li>이때 대여한 책의 갯수를 count하기 위해 ‘상태’열을 읽어서 ‘–없음–‘이 없는 갯수로 판단을 하기로 정했다</li>
</ul>

<h2 id="문제-분석">문제 분석</h2>
<ul>
  <li>
    <p>아래는 대여한 책의 갯수를 세는 함수이다</p>

    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="rouge-code"><pre>  <span class="k">def</span> <span class="nf">total_books_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
      <span class="k">if</span> <span class="s">'상태'</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s">'--없음--'</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">[</span><span class="s">'상태'</span><span class="p">]:</span>
          <span class="n">counter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">[</span><span class="s">'상태'</span><span class="p">].</span><span class="n">value_count</span><span class="p">()[</span><span class="s">'--없음--'</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">counter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">df</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">counter</span>
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p>위 함수는 오류가 있다</p>
    <ul>
      <li>참고할 SO답변1 링크 : <a href="https://stackoverflow.com/a/49393472/9457247">Using in operator with Pandas series</a>
</li>
      <li>참고할 SO답변2 링크 : <a href="https://stackoverflow.com/a/21320011/9457247">How to determine whether a Pandas Column contains a particular vaule</a>
</li>
      <li>즉, Series 객체에 직접 <code class="language-html highlighter-rouge">in</code> 연산자를 사용하면 “Values”가 아닌 “indexes”만 검사하기 때문이다</li>
    </ul>
  </li>
</ul>

<h2 id="해결책">해결책</h2>
<ul>
  <li>따라서 해결책은 <code class="language-html highlighter-rouge">'--없음--' in self.df['상태']</code> 부분을 다음과 같이 고치는 것이다
    <ul>
      <li><code class="language-html highlighter-rouge">self.df['상태'].str.contains('--없음--').any()</code></li>
      <li><code class="language-html highlighter-rouge">self.df['상태'].isin(['--없음--']).any()</code></li>
      <li>
<code class="language-html highlighter-rouge">self.df['상태'].eq("--없음--").any()</code> : 가장 간결하여 선택함</li>
    </ul>
  </li>
</ul>


    </article>


    
    <div class="post-comments">
    
    
        <script src="https://utteranc.es/client.js" repo="honggaruy/honggaruy.github.io" issue-term="pathname" label="Comment" theme="github-light" crossorigin="anonymous" async>
        </script>
    
    </div>




</div>
<script>
    ;(function() {
        var tags = document.querySelectorAll('.post-tag');
        if(tags == null || tags.length < 1) {
            return;
        }

        for (var i = 0; i < tags.length; i++) {
            var item = tags[i];
            var tagList = item.innerHTML.trim();

            if(/^\s*$/.test(tagList)) {
                continue;
            }
            tagList = tagList.split(/\s+/)
                .map(function(tag) {
                    return `<a href="/tag/#${tag}">#${tag}</a>`;
                })
                .join(' ');
            tags[i].innerHTML = tagList;
        }
        return;
    })();
    ;(function() {
        var post = document.querySelector('article.post-content');

        if(post == null) {
            return;
        }

        (function iterate_node(node) {

            if (/^(?:p|ul|h\d|table)$/i.test(node.tagName)) {

                node.innerHTML = link(node.innerHTML);

            } else { // Node.ELEMENT_NODE
                for (var i = 0; i < node.childNodes.length; i++) {
                    iterate_node(node.childNodes[i]);
                }
            }
        })(post);

        function link(content) {
            content = content.replace(/\\\[\[(.+?)\]\]/g, '\\[\\[$1\\]\\]');
            content = content.replace(/\[\[(.+?)\]\]\{(.+?)\}/g, '<a href="../$1">$2</a>');
            content = content.replace(/\[\[(.+?)\]\]/g, '<a href="../$1">$1</a>');
            content = content.replace(/\\\[\\\[(.+?)\\\]\\\]/g, '[[$1]]');
            return content;
        }

    })();
</script>


<script src="/js/axios.min.js"></script>
<script async src="/js/parent.js"></script>

            </div>
        </div>
        <footer class="footer">
    <div>

    </div>
</footer>
    
</body>
</html>
