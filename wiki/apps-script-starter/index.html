<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>로컬에서 구글 Apps Script 개발하기 - 홍가뤼의 개인위키</title>

    <meta name="description" content="튜토리얼 따라하기">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://honggaruy.github.io/wiki/apps-script-starter/">
    <link rel="alternate" type="application/rss+xml" title="홍가뤼의 개인위키" href="https://honggaruy.github.io/feed.xml">

    <meta property="og:type" content="website">
    <meta property="og:title" content="로컬에서 구글 Apps Script 개발하기">
    <meta property="og:description" content="튜토리얼 따라하기">
    <meta property="og:image" content="https://honggaruy.github.io/resources/icon/apple-touch-icon.png">
    <meta property="og:url" content="https://honggaruy.github.io/wiki/apps-script-starter/">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:url" content="https://honggaruy.github.io/wiki/apps-script-starter/">
    <meta name="twitter:title" content="로컬에서 구글 Apps Script 개발하기">
    <meta name="twitter:description" content="튜토리얼 따라하기">

    <link rel="apple-touch-icon" sizes="180x180" href="/resources/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/resources/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/resources/icon/favicon-16x16.png">
    <link rel="manifest" href="/resources/icon/site.webmanifest">




</head>
<body>
<header class="header">
    <div>
        <a class="site-title" href="/">홍가뤼의 개인위키</a>
    </div>
    <div>
        <a class="site-title-right" href="/about/">me</a>
    </div>
    <div>
        <a class="site-title-right" href="/wiki/index/#random" onclick="if(typeof random === 'function')random()">random</a>
    </div>
    <div>
        <a class="site-title-right" href="/blog/">blog</a>
    </div>
    <div>
        <a class="site-title-right" href="/wiki/index/">wiki</a>
    </div>
</header>

    
        <div class="page-content">
            <div class="search">
    <form role="search" method="get" action="/search/">
         <input name="searchString" class="searchInput" placeholder=" 검색하세요" type="text">
         <input type="submit" class="searchButton" value="Search">
    </form>
</div>
            <div class="post">
                
<input type="hidden" id="thisName" value="apps-script-starter">
<div class="post">
    <header class="post-header">
        <h1 class="post-title">로컬에서 구글 Apps Script 개발하기</h1>
    
        <p class="title-summary">튜토리얼 따라하기</p>
    
        <div class="history-button">
            <p><a href="https://github.com/honggaruy/honggaruy.github.io/blame/master/_wiki/apps-script-starter.md" target="_blank">created: 2020.06.06</a></p>
            <p><a href="https://github.com/honggaruy/honggaruy.github.io/blame/master/_wiki/apps-script-starter.md" target="_blank">updated: 2022.06.30</a></p>
            <p>
                <a href="https://github.com/honggaruy/honggaruy.github.io/edit/master/_wiki/apps-script-starter.md">편집하기</a>
                
                /
                <a href="https://github.com/honggaruy/honggaruy.github.io/issues/new?title=%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C+%EA%B5%AC%EA%B8%80+Apps+Script+%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0&amp;body=%EC%9D%98%EA%B2%AC%EC%9D%84%20%EB%82%A8%EA%B2%A8%EC%A3%BC%EC%84%B8%EC%9A%94">의견 남기기</a>
                
            </p>
        </div>
        <div id="parent-list"></div>


    <div class="post-tag">
    google-apps-script
</div>




    </header>
    <article class="post-content">
        <ul id="markdown-toc">
  <li><a href="#1-%EB%B0%9C%EB%8B%A8" id="markdown-toc-1-발단">1. 발단</a></li>
  <li>
<a href="#2-%EC%A0%84%EA%B0%9C" id="markdown-toc-2-전개">2. 전개</a>    <ul>
      <li>
<a href="#amit-agarwal-way" id="markdown-toc-amit-agarwal-way">Amit Agarwal 방식 (현재 사용하지 않음)</a>        <ul>
          <li><a href="#section" id="markdown-toc-section">환경 설치</a></li>
          <li><a href="#section-1" id="markdown-toc-section-1">코딩 시작전</a></li>
          <li><a href="#section-2" id="markdown-toc-section-2">코딩</a></li>
          <li><a href="#section-3" id="markdown-toc-section-3">소감</a></li>
        </ul>
      </li>
      <li>
<a href="#clasp-and-typescript" id="markdown-toc-clasp-and-typescript">Clasp + Typescript로 GAS 프로젝트 시작하기 (현재 사용중인 방법)</a>        <ul>
          <li><a href="#%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC" id="markdown-toc-개념정리">개념정리</a></li>
          <li>
<a href="#%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95" id="markdown-toc-환경-설정">환경 설정</a>            <ul>
              <li><a href="#%EC%8B%A0%EA%B7%9C-typescript-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1-quickstart" id="markdown-toc-신규-typescript-프로젝트-생성-quickstart">신규 TypeScript 프로젝트 생성 QuickStart</a></li>
            </ul>
          </li>
          <li><a href="#clasp-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EB%A1%9C-%EB%A7%8C%EB%93%A4%EA%B8%B0" id="markdown-toc-clasp-프로젝트로-만들기">Clasp 프로젝트로 만들기</a></li>
          <li>
<a href="#%EB%AA%A8%EB%93%88-exports-%EC%99%80-imports" id="markdown-toc-모듈-exports-와-imports">모듈, exports 와 imports</a>            <ul>
              <li><a href="#exports-%EC%84%A0%EC%96%B8-%ED%95%B4%EA%B2%B0%EC%B1%85" id="markdown-toc-exports-선언-해결책"><code class="language-html highlighter-rouge">exports</code> 선언 해결책</a></li>
              <li><a href="#namespace-%EC%8B%A4%ED%96%89%EB%AC%B8-%ED%95%B4%EA%B2%B0%EC%B1%85" id="markdown-toc-namespace-실행문-해결책"><code class="language-html highlighter-rouge">namespace</code> 실행문 해결책</a></li>
              <li><a href="#third-party-build-chain-%ED%95%B4%EA%B2%B0%EC%B1%85" id="markdown-toc-third-party-build-chain-해결책">third party build-chain 해결책</a></li>
            </ul>
          </li>
          <li>
<a href="#%EC%84%A4%EC%A0%95" id="markdown-toc-설정">설정</a>            <ul>
              <li><a href="#clasp-github%EC%97%90%EC%84%9C-%EA%B1%B4%EC%A7%84-vscode-%EC%84%A4%EC%A0%95" id="markdown-toc-clasp-github에서-건진-vscode-설정">clasp github에서 건진 VSCode 설정</a></li>
            </ul>
          </li>
          <li><a href="#git-repository%EC%97%90-%EC%9E%88%EB%8A%94-clasp_xxx-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%9D%98-%EA%B5%AC%EC%84%B1" id="markdown-toc-git-repository에-있는-clasp_xxx-프로젝트의-구성">git repository에 있는 clasp_xxx 프로젝트의 구성</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="1-발단">1. 발단</h1>

<ul>
  <li>최근에 google-apps-script 프로젝트를 한 개 끝냈는데 …
    <ul>
      <li>
<a href="https://github.com/pyscaffold/pyscaffold">pyscaffold</a> 처럼 초기에 환경을 설정해주는 툴이 있을것 같아 찾아봤다.</li>
    </ul>
  </li>
  <li>찾았는데 .. <a href="https://github.com/labnol/apps-script-starter">Google Apps Script Development</a> 인 것 갈다.
    <ul>
      <li>작성자는 Amit Agarwal이라는 인도사람이며 <a href="https://www.labnol.org/about">인도 최초의 전업 블로거</a>라고 한다.</li>
      <li>블로그 내용에 Google Apps Script 관련내용이 많고 직접 개발한 add-on도 많아 왠지 믿음이 간다.</li>
      <li>
<a href="https://www.labnol.org/internet/google-apps-script-developers/32305/">Google Apps Script for Developers</a> 는 블로그에 관련글을 쓴내용이며 직접 설명한 유튜브 링크도 포함하고 있다.</li>
    </ul>
  </li>
  <li>한번 유튜브 비디오를 따라해보면서 익혀보기로 했다.</li>
</ul>

<h1 id="2-전개">2. 전개</h1>

<h2 id="amit-agarwal-way">Amit Agarwal 방식 (현재 사용하지 않음)</h2>

<style>
  details > summary {
    background-color: #ddd;
    border: none;
    box-shadow: 3px 3px 4px black;
    cursor: pointer;
  }
</style>

<details>
  <summary> 처음에 한 번 해봤지만 현재 사용하지 않는 방식이라 접어둠. 내용 보려면 Click !! </summary>

  <h3 id="section">환경 설치</h3>

  <ul>
    <li>일단 첨에 해당 git을 클론해온다. 비디오에서 하라는 대로 이름을 <code class="language-html highlighter-rouge">mailman</code>으로 해본다.</li>
    <li>
<code class="language-html highlighter-rouge">git clone</code>을 하면 <code class="language-html highlighter-rouge">.git</code> 폴더가 생기는데, 일단 지운다
      <ul>
        <li>신규 프로젝트를 하려고 클론을 하는거기 때문에, 필요없는 history를 지우기 위함이다.</li>
        <li>현재 폴더가 <code class="language-html highlighter-rouge">mailman</code>인 상황에서 <code class="language-html highlighter-rouge">rm -rf .git</code>
</li>
      </ul>
    </li>
    <li>아무것도 없는 상태로 시작하기 위해, 샘플 프로그램이 있는 <code class="language-html highlighter-rouge">src</code> 폴더도 제거한다.
      <ul>
        <li>현재 폴더가 <code class="language-html highlighter-rouge">mailman</code>인 상황에서 <code class="language-html highlighter-rouge">rm -rf src</code>
</li>
      </ul>
    </li>
    <li>node가 깔려있는 상태에서 시작하는걸로 가정한다.
      <ul>
        <li>노드 버전 확인 명령 : <code class="language-html highlighter-rouge">node -v</code>
</li>
      </ul>
    </li>
    <li>다음에 개발하는데 필요한 모든 dependency를 설치한다
      <ul>
        <li>명령 : <code class="language-html highlighter-rouge">npm install</code>
</li>
        <li>참조링크 <a href="https://docs.npmjs.com/cli/install">npm-install</a>
          <ul>
            <li>참조하는 파일 - 해당 git에 미리 등록되어 있다.
              <ul>
                <li>
<a href="https://docs.npmjs.com/files/package.json">package.json</a> : depencies를 선언하는 파일</li>
                <li>
<a href="https://docs.npmjs.com/files/package-lock.json">package-lock.json</a> : npm을 사용해서 <code class="language-html highlighter-rouge">node_modules</code> 트리나 <code class="language-html highlighter-rouge">package.json</code> 파일을 수정하면 자동으로 생성. 파일이 생성되는 시점의 의존성 트리에 대한 정확한 정보를 <strong>고정(lock)</strong>함</li>
                <li><a href="https://hyunjun19.github.io/2018/03/23/package-lock-why-need/">package-lock.json 파일을 저장소에 같이 commit 해야하는 이유</a></li>
                <li>설치해보면 다음과 같은데..</li>
              </ul>

              <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>npm <span class="nb">install
</span>npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.11 <span class="o">(</span>node_modules<span class="se">\f</span>sevents<span class="o">)</span>:
npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="k">for </span>fsevents@1.2.11: wanted <span class="o">{</span><span class="s2">"os"</span>:<span class="s2">"darwin"</span>,<span class="s2">"arch"</span>:<span class="s2">"any"</span><span class="o">}</span> <span class="o">(</span>current: <span class="o">{</span><span class="s2">"os"</span>:<span class="s2">"win32"</span>,<span class="s2">"arch"</span>:<span class="s2">"x64"</span><span class="o">})</span>
added 1048 packages from 451 contributors and audited 1119 packages <span class="k">in </span>166.52s
      
43 packages are looking <span class="k">for </span>funding
  run <span class="sb">`</span>npm fund<span class="sb">`</span> <span class="k">for </span>details
        
found 6 low severity vulnerabilities
  run <span class="sb">`</span>npm audit fix<span class="sb">`</span> to fix them, or <span class="sb">`</span>npm audit<span class="sb">`</span> <span class="k">for </span>details
</pre></td>
</tr></tbody></table></code></pre></div>              </div>
              <ul>
                <li>
<a href="https://www.npmjs.com/package/fsevents">fsevents</a> : MacOS의 FSEvents 관련 라이브러리
                  <ul>
                    <li>“os”:”darwin”을 원하는데.. 현재는 “os”:”win32”라고 나오고.. 현재 플랫폼이 지원되지 않는다고 나온다.</li>
                    <li>
<a href="https://ko.wikipedia.org/wiki/%EB%8B%A4%EC%9C%88_(%EC%9A%B4%EC%98%81_%EC%B2%B4%EC%A0%9C)#.EC.B6.9C.EC.8B.9C">darwin</a>은 MacOS의 기본 OS이다.</li>
                    <li>Windows 환경에서 필요없는 라이브러리이므로 무시한다</li>
                  </ul>
                </li>
                <li>취약점(vulnerabilities) 관련
                  <ul>
                    <li>참고 : <a href="https://blog.outsider.ne.kr/1375">npm에 새로 추가된 audit 기능</a>
</li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <h3 id="section-1">코딩 시작전</h3>

  <ul>
    <li>clasp login후 clasp create로 프로젝트 만들기
      <ul>
        <li>명령 : <code class="language-html highlighter-rouge">clasp create --type sheets --title "MailMan" --rootDir ./dist</code>
</li>
        <li>시트와 관련 script를 한꺼번에 만드는 명령</li>
      </ul>
    </li>
    <li>Cloud script editor 에서 안된다고 하는 명령이 일부 되는듯함.</li>
    <li>root에 <code class="language-html highlighter-rouge">src</code> 디렉토리를 새로 만듬 ( subfoloder로 <code class="language-html highlighter-rouge">html</code>도 만듬)</li>
    <li>코딩 시작전에 ./webpack.config.js 편집
      <div class="language-js highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre><span class="nx">cons</span> <span class="nx">isProduction</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">production</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// 위값을 'none' 으로 변경 , none 이 development mdoe라고 함.</span>
<span class="c1">// production mode로 되어 있으면 코드가 최적화 되지만 읽기불편하고 debug하기가 어려움</span>
</pre></td>
</tr></tbody></table></code></pre></div>      </div>
      <ul>
        <li><a href="http://jeonghwan-kim.github.io/js/2017/05/15/webpack.html">웹팩의 기본 개념</a></li>
      </ul>
    </li>
    <li>다음으로 appsscript.json을 편집
      <ul>
        <li>appsscript.json 편집시에 권한을 조정했는데 자세한 사항은 <a href="https://developers.google.com/oauthplayground/">google developer playground</a>를 참조하면 모든 권한이 나옴</li>
      </ul>
    </li>
  </ul>

  <h3 id="section-2">코딩</h3>

  <ul>
    <li>따라 하는 html path 설정관련해서 에러가 남</li>
    <li>webpack.config.js에서 다음부분을 수정함
      <div class="language-js highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="rouge-code"><pre><span class="k">new</span> <span class="nx">CopyWebpackPlugin</span><span class="p">({</span>
<span class="na">patterns</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">from</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">src</span><span class="p">}</span><span class="s2">/html/index.html`</span><span class="p">,</span> <span class="c1">// 원래는 `${src}/**/*.html`로 되어있었음</span>
    <span class="na">flatten</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">destination</span><span class="p">,</span>
  <span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div>      </div>
    </li>
    <li>이후에는 쭉 따라하면 별 문제없이 잘된다</li>
  </ul>

  <h3 id="section-3">소감</h3>

  <ul>
    <li>체계적이긴 하나, 좀 예전에 작성된 느낌</li>
    <li>webpack으로 빌드하는데 너무 오래 걸림 ( 느리면 50초 이상, 빠르면 20초 이상)</li>
    <li>일단 다른 방법을 좀 찾아보기로 함</li>
    <li><a href="https://www.copypastecharacter.com/">특수문자 복사하는 사이트</a></li>
  </ul>

</details>

<h2 id="clasp-and-typescript">Clasp + Typescript로 GAS 프로젝트 시작하기 (현재 사용중인 방법)</h2>

<ul>
  <li>본 섹션은 custom-id 사용중입니다. (링크 걸 때 주의)</li>
  <li>목적 : 오랜만에 Google Apps Script 를 다시 시작할때 도움이 될 정보 정리</li>
  <li>참조한 자료
    <ul>
      <li><a href="https://github.com/google/clasp/blob/master/docs/typescript.md">clasp github중 TypeScript doc</a></li>
      <li>Google Apps Script - Guide
        <ul>
          <li><a href="https://developers.google.com/apps-script/guides/clasp">Command Line Interface using clasp</a></li>
          <li><a href="https://developers.google.com/apps-script/guides/typescript">Using TypeScript</a></li>
          <li>codelabs: <a href="https://codelabs.developers.google.com/codelabs/clasp/">clasp - The Apps Script CLI</a> - clasp 따라해보기</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="개념정리">개념정리</h3>

<ul>
  <li>GAS 의 2가지 개발 시작 방법
    <ul>
      <li>온라인 : 구글 문서(Sheets, Docs, Presentations, Forms,..)에서 <code class="language-html highlighter-rouge">스크립트 편집기</code>를 열어 온라인으로 작업</li>
      <li>오프라인 : <code class="language-html highlighter-rouge">clasp</code>을 다운로받아 로컬에서 작업후 온라인에 연동시키기</li>
    </ul>
  </li>
  <li>
<code class="language-html highlighter-rouge">clasp</code>을 쓸 때 유리한 점
    <ul>
      <li>온라인이 아닌 상황에서도 개발할 수 있다. (실행할 때는 연결해야 겠지만)</li>
      <li>
<code class="language-html highlighter-rouge">git</code>등을 사용하여 코드 버전 관리를 할 수 있다</li>
      <li>폴더를 사용해 구조적으로 코드를 분리할 수 있다</li>
      <li>
<code class="language-html highlighter-rouge">Typescript</code>를 사용하여 개발할 수 있다
        <ul>
          <li>
<code class="language-html highlighter-rouge">Typescript</code>를 사용하면 유리한 점
            <ul>
              <li>Autocomplete을 지원하는 로컬 IDE 사용가능</li>
              <li>
<code class="language-html highlighter-rouge">class</code>나 <code class="language-html highlighter-rouge">arrow function</code>등을 지원하는 ES6 특징을 이용할 수 있다</li>
            </ul>
          </li>
          <li>주의 : 일단 한 번 <code class="language-html highlighter-rouge">Typescript</code>를 이용한 프로젝트는 계속 Typescript를 이용해야 한다 (서버에 올라가면서 transfile 되기 때문)</li>
          <li>주의 : GAS에서 허용되는 Typescript는 Node나 Web browser에서 허용되는 Typescript와 정확히 같지는 않다
            <ul>
              <li>
<code class="language-html highlighter-rouge">export</code>나 <code class="language-html highlighter-rouge">require</code>등의 용어를 사용할 수 없다.</li>
              <li>
<code class="language-html highlighter-rouge">window</code>등의 용어를 사용할 수 없다.</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="환경-설정">환경 설정</h3>

<ul>
  <li>자세한 설명이 필요하면 개인 유튜브 영상(<a href="https://youtu.be/4Qlt3p6N0es">CLASP Tutorial</a>)을 확인 한다</li>
  <li><a href="https://developers.google.com/apps-script/guides/clasp#installation">clasp 설치</a></li>
  <li><a href="https://developers.google.com/apps-script/guides/clasp#using_clasp">clasp 초기기동</a></li>
  <li>오랜만에 돌아왔을 때는..
    <ul>
      <li>
<code class="language-html highlighter-rouge">clasp -v</code> 명령으로 clasp이 설치 되어있는지 확인하자</li>
    </ul>
  </li>
</ul>

<h4 id="신규-typescript-프로젝트-생성-quickstart">신규 TypeScript 프로젝트 생성 QuickStart</h4>

<ol>
  <li>프로젝트를 저장할 폴더 생성
    <ul>
      <li>이름을 잘 고민할 것</li>
    </ul>
  </li>
  <li>git init 실행
    <ul>
      <li>git으로 관리할 필요가 있을 때</li>
    </ul>
  </li>
  <li>npm init 실행
    <ul>
      <li>node package 배포용 환경을 만들기 위한것이지만 여기선 <code class="language-html highlighter-rouge">package.json</code>을 만들기 위해 실행
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>  <span class="c">#아무것도 묻지 않고 실행완료</span>
  npm init <span class="nt">-y</span>
</pre></td>
</tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Apps Script 용 Type definition 설치
    <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>  npm i <span class="nt">-D</span> @types/google-apps-script
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>프로젝트 루트에 <code class="language-html highlighter-rouge">tsconfig.json</code> 파일을 다음과 같이 작성하여 TypeScript feature를 활성화 한다.
    <ul>
      <li>만들기 전에 바로 윗 단계인 <code class="language-html highlighter-rouge">Type definition</code>을 설치하면 tsconfig.json 편집시 <code class="language-html highlighter-rouge">auto completion</code>이 지원된다.</li>
      <li>
<code class="language-html highlighter-rouge">.clasp.json</code> 파일과 같은 곳에 위치시킨다.</li>
      <li>
<code class="language-html highlighter-rouge">"compilerOptions"</code> 섹션만 의미 있고 다른 설정은 무시된다.</li>
      <li>Apps Script Project가 <code class="language-html highlighter-rouge">V8 Engine</code>을 사용하도록 설정되었다면, “target”: “ES2019”로 설정한다. (default: “ES3”)
        <div class="language-js highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="rouge-code"><pre>  <span class="p">{</span>
   <span class="dl">"</span><span class="s2">comilerOptions</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
   <span class="dl">"</span><span class="s2">lib</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">esnext</span><span class="dl">"</span><span class="p">],</span>
   <span class="dl">"</span><span class="s2">target</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ES2019</span><span class="dl">"</span><span class="p">,</span>
   <span class="dl">"</span><span class="s2">experimentalDecorators</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span>
   <span class="p">}</span>
  <span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>다음은 생성한 폴더를 <code class="language-html highlighter-rouge">clasp project</code>로 만들어야 하는데 …</li>
</ol>

<ul>
  <li>참조
    <ul>
      <li><a href="https://github.com/google/clasp/blob/master/docs/typescript.md">typeScript , clasp github</a></li>
      <li>
<a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html#handbook-content">What is a tsconfig, typescriptlang.org</a>
        <ul>
          <li><a href="https://www.typescriptlang.org/tsconfig#lib">lib option in tsconfig Ref., typescritlang.org</a></li>
          <li><a href="https://www.typescriptlang.org/tsconfig#target">target option in tsconfig Ref., typescriptlang.org</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="clasp-프로젝트로-만들기">Clasp 프로젝트로 만들기</h3>

<ul>
  <li>script.google.com 사이트에 접속하기 전에 <code class="language-html highlighter-rouge">clasp create</code> 방식으로 설정</li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>prompt<span class="nv">$ </span>clasp create <span class="nt">--title</span> <span class="s2">"Name of Project"</span> <span class="nt">--rootDir</span> src 
</pre></td>
</tr></tbody></table></code></pre></div></div>

<ul>
  <li>위와 같이 실행시 <code class="language-html highlighter-rouge">? Create which script?</code> 로 물어봄. 여기서 script 종류를 선택해도 되고…</li>
  <li>아래와 같이 처음부터 종류를 선택하고 들어갈수 도 있음.</li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>  prompt<span class="nv">$ </span>clasp create <span class="nt">--type</span> sheets <span class="nt">--title</span> <span class="s2">"sheet Project"</span> <span class="nt">--rootDir</span> src
</pre></td>
</tr></tbody></table></code></pre></div></div>

<ul>
  <li>이 방식 말고  script.google.com 사이트에 미리 프로젝트 만들어놓고 clone 하는 방식이 있는데 내 취향이 아님.</li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>prompt<span class="nv">$ </span>clasp clone <span class="s2">"&lt;script_Id&gt;"</span> <span class="nt">--rootDir</span> src
</pre></td>
</tr></tbody></table></code></pre></div></div>

<ul>
  <li>프로젝트 폴더밑에 <code class="language-html highlighter-rouge">src</code> 디렉토리를 만들면 나중에 만들게 될 배포및 테스트 폴더와 구분 되어 좋음.</li>
</ul>

<h3 id="모듈-exports-와-imports">모듈, exports 와 imports</h3>

<ul>
  <li>Google Apps Script는 ES 모듈은 현재 지원하지 않음. 일반적인 <code class="language-html highlighter-rouge">export</code>/<code class="language-html highlighter-rouge">import</code> 패턴은 실패함.</li>
  <li>실패하는 패턴은 다음과 같다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>  <span class="c1">// module.ts</span>
  <span class="c1">// 'fool' is added to the 'exports' object in the global namespace</span>
  <span class="k">export</span> <span class="kd">const</span> <span class="nx">foo</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello form Module</span><span class="dl">'</span><span class="p">;</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre>  <span class="c1">// main.ts</span>
  <span class="k">import</span> <span class="p">{</span> <span class="nx">foo</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./module</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// this statement is ignored</span>
  
  <span class="c1">// the variable 'fool` does not exist in the global namespace</span>
  <span class="nx">cons</span> <span class="nx">bar</span> <span class="o">=</span> <span class="nx">foo</span><span class="p">;</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>
<h4 id="exports-선언-해결책">
<code class="language-html highlighter-rouge">exports</code> 선언 해결책</h4>

<ul>
  <li>이 해결책은 일반적인 모듈이 지원하는 code isolation조차 지원하지 않으므로, 찾기 어려운 버그를 낼수 있음을 주의</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>  <span class="nx">declare</span> <span class="kd">const</span> <span class="nx">exports</span><span class="p">:</span> <span class="k">typeof</span> <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">./module</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="nx">exports</span><span class="p">.</span><span class="nx">foo</span><span class="p">;</span>  <span class="c1">// address "imported" content as it will be visible when transpiled</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<h4 id="namespace-실행문-해결책">
<code class="language-html highlighter-rouge">namespace</code> 실행문 해결책</h4>

<ul>
  <li>이전에 “internal module”로 알려졌던, TypeScript의 “namespaces”를 이용하며, 적절한 code isolation의 목적을 이룬다</li>
  <li>Namespace definition은 중첩될수 있으며, 여러 파일에서 사용될수 있고, <code class="language-html highlighter-rouge">import</code>/<code class="language-html highlighter-rouge">require</code> 문장이 필요하지 않다.</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre> <span class="c1">// module.ts</span>
 <span class="nx">namespace</span> <span class="nx">Module</span> <span class="p">{</span>
    <span class="k">export</span> <span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{}</span>
    <span class="kd">function</span> <span class="nx">bar</span><span class="p">()</span> <span class="p">{}</span>  <span class="c1">// this function can only be addressed from within the 'Module' namespace</span>
 <span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre> <span class="c1">// anyFiles.ts</span>
 <span class="nx">Module</span><span class="p">.</span><span class="nx">foo</span><span class="p">();</span>   <span class="c1">// address a namespace's exported content directly</span>
 
 <span class="kd">const</span> <span class="nx">nameIWantForMyImports</span> <span class="o">=</span> <span class="nx">Module</span><span class="p">.</span><span class="nx">foo</span><span class="p">;</span>   <span class="c1">// to simulate 'import' with renaming</span>
 <span class="nx">nameIWantForMyImports</span><span class="p">();</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>
<ul>
  <li>
<code class="language-html highlighter-rouge">namespace</code>의 좀 더 자세한 예제는 <a href="https://github.com/PopGoesTheWza/ts-gas-project-starter">ts-gas-project-starter</a>에 나와있다.</li>
</ul>

<h4 id="third-party-build-chain-해결책">third party build-chain 해결책</h4>

<ul>
  <li>webpack, rollup.js, gulp 등등의 써드 파티 도구를 이용한 방법</li>
  <li>다음 단계와 같이 수행한다</li>
</ul>

<ol>
  <li>코드를 파싱해서 사용된 모듈을 확인한다. ( export 와 import 사용)</li>
  <li>(선택적) 사용하지 않는 코드를 제거하기 위해 나무 흔들기?를 한다.</li>
  <li>결과를 한개의 javascript 패키지로 모은다.</li>
</ol>

<h3 id="설정">설정</h3>

<h4 id="clasp-github에서-건진-vscode-설정">clasp github에서 건진 VSCode 설정</h4>

<ul>
  <li>
<a href="https://github.com/google/clasp/blob/master/docs/settings.md">clasp github/docs/settings.md</a> 에서 건진 VSCode 설정</li>
  <li>일단 써진대로 <code class="language-html highlighter-rouge">Code &gt; Prefereces &gt; Settings</code> 로 들어간다</li>
  <li>
<code class="language-html highlighter-rouge">User &gt; Extensions</code> 메뉴에 <code class="language-html highlighter-rouge">JSON</code>을 찾아 <code class="language-html highlighter-rouge">Schemas</code>에 <code class="language-html highlighter-rouge">Edit in settings.json</code>을 찾는다.</li>
  <li>들어 가서 추천하는 명령은 선택하면 일단 넣을수 있는 템플릿이 완성된다.</li>
</ul>

<h3 id="git-repository에-있는-clasp_xxx-프로젝트의-구성">git repository에 있는 clasp_xxx 프로젝트의 구성</h3>

<ul>
  <li>요약 : 트리구조및 공통되는 파일쓰임새</li>
  <li>구글시트용 GAS 트리구조
    <div class="language-html highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td>
<td class="rouge-code"><pre># root
├── node_modules/  ( ignored )
├── src/
│   ├─ appsscript.json - 필수 파일, timezone 설정, Library 설정 등등 (필수 파일)
│   ├─ forms.ts - 옵션, 설문지를 사용한다면 있어야 함 
│   ├─ sheets.ts - 거의 필수, 각 시트별로 직접적으로 조작하는 함수를 설정 ( 구글 시트라면 필수) 
│   ├─ typealiases.ts - 거의 필수, .ts 파일에서 타입길이를 줄이기 위해 사용, .gs로 컴파일하면 내용이 사라지는 파일 (.ts일때만 내용이 존재) 
│   ├─ util.ts - 모듈간에 공통적으를 쓸만한 유틸리티 함수. 2D공간에서 검색하는 함수등이 있음 
│   └─ main.ts - entry point UI 설정, 최상위 함수 호출
├─ .clasp.json - Google Drive상에 연동되는 스크립트 파일 ID저장 
├─ .claspignore - clasp compiler시에 무시되는 함수 등록 
├─ .gitignore - git 관리 시에 무시되는 함수 등록 
├─ LICENSE - github 등록시 LICENSE 표시용 
  
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

    </article>


    
    <div class="post-comments">
    
    
        <script src="https://utteranc.es/client.js" repo="honggaruy/honggaruy.github.io" issue-term="pathname" label="Comment" theme="github-light" crossorigin="anonymous" async>
        </script>
    
    </div>




</div>
<script>
    ;(function() {
        var tags = document.querySelectorAll('.post-tag');
        if(tags == null || tags.length < 1) {
            return;
        }

        for (var i = 0; i < tags.length; i++) {
            var item = tags[i];
            var tagList = item.innerHTML.trim();

            if(/^\s*$/.test(tagList)) {
                continue;
            }
            tagList = tagList.split(/\s+/)
                .map(function(tag) {
                    return `<a href="/tag/#${tag}">#${tag}</a>`;
                })
                .join(' ');
            tags[i].innerHTML = tagList;
        }
        return;
    })();
    ;(function() {
        var post = document.querySelector('article.post-content');

        if(post == null) {
            return;
        }

        (function iterate_node(node) {

            if (/^(?:p|ul|h\d|table)$/i.test(node.tagName)) {

                node.innerHTML = link(node.innerHTML);

            } else { // Node.ELEMENT_NODE
                for (var i = 0; i < node.childNodes.length; i++) {
                    iterate_node(node.childNodes[i]);
                }
            }
        })(post);

        function link(content) {
            content = content.replace(/\\\[\[(.+?)\]\]/g, '\\[\\[$1\\]\\]');
            content = content.replace(/\[\[(.+?)\]\]\{(.+?)\}/g, '<a href="../$1">$2</a>');
            content = content.replace(/\[\[(.+?)\]\]/g, '<a href="../$1">$1</a>');
            content = content.replace(/\\\[\\\[(.+?)\\\]\\\]/g, '[[$1]]');
            return content;
        }

    })();
</script>


<script src="/js/axios.min.js"></script>
<script async src="/js/parent.js"></script>

            </div>
        </div>
        <footer class="footer">
    <div>

    </div>
</footer>
    
</body>
</html>
